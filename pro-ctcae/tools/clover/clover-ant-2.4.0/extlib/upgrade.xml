<project name="Clover Jar Upgrader" basedir="." default="jfreechart.upgrade">
    <description>Script to upgrade the clover.jar with the latest jfreechart.jar .</description>

    <property name="pkg.dir" value=".."/>

    <!-- Change this location to point to the new jfreechart version -->
    <property name="jfreechart.jar" location="jfreechart-1.0.8.jar"/>

    <!-- The location of the clover.jar to use for the upgrade. -->
    <property name="clover.jar" value="${pkg.dir}/lib/clover.jar"/>

    <!-- The location of the upgraded clover jar -->
    <property name="clover-upgraded.jar" value="${pkg.dir}/lib/clover-upgraded.jar"/>

    <target name="jfreechart.upgrade"
            description="Replaces the existing re-packaged jfree library with another version">
        <taskdef name="jarjar"
                 classname="com.tonicsystems.jarjar.JarJarTask"
                 classpath="jarjar-1.0rc7.jar"/>

        <echo>Upgrading jfreechart: ${jfreechart.jar} for: ${clover.jar}</echo>

        <jarjar jarfile="${clover-upgraded.jar}">
            <zipfileset src="${jfreechart.jar}"/>
            <zipfileset src="${clover.jar}">
                <exclude name="**/org/jfree/**"/>
            </zipfileset>
            <rule pattern="org.jfree.**" result="clover.@0"/>
        </jarjar>

        <echo>Done. Upgraded jar saved to: ${clover-upgraded.jar}</echo>

    </target>
</project>